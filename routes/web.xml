<?xml version="1.0" encoding="UTF-8" ?>
<routes>
    <route-group namespace="App\Portal\Controllers\">
        <middleware name="App\Middleware\ComingSoon"/>

        <route method="get" uri="test" as="test" controller="TestController" use="testEmail"/>

        <route method="get" uri="" as="home" controller="HomeController" use="home"/>

        <route method="get" uri="kozossegek" as="portal.groups" controller="GroupController" use="kozossegek"/>
        <route method="get" uri="kozossegek/page/{page}/" as="portal.groups.page" controller="GroupController" use="kozossegek"/>
        <route method="get" uri="kozosseg/{varos}/{intezmeny}/{kozosseg}" as="kozosseg" controller="GroupController" use="kozosseg"/>
        <route method="get" uri="feedback" as="portal.feedback" view="portal.feedback"/>

        <!-- Közösség kapcsolatfelvételi űrlap -->
        <route method="post" uri="group-contact-form" as="portal.group-contact-form" controller="GroupController" use="groupContactForm"/>
        <route method="post" uri="send-contact-message" as="portal.contact-group" controller="GroupController" use="sendContactMessage"/>

        <route-group middleware="App\Middleware\LoggedInMiddleware">
            <route method="get" uri="profile" as="portal.my_profile" controller="UserController" use="profile"/>
            <route method="post" uri="profile/update" as="portal.profile.update" controller="UserController" use="update"/>
            <route method="get" uri="my-group" as="portal.my_group" controller="GroupController" use="myGroup"/>
            <route method="post" uri="update-group" as="portal.my_group.update" controller="GroupController" use="updateMyGroup"/>
            <route method="post" uri="create-group" as="portal.my_group.create" controller="GroupController" use="createMyGroup"/>
        </route-group>
    </route-group>

    <!-- BELÉPÉS -->
    <route method="get" uri="login" controller="App\Portal\Controllers\LoginController" use="login" as="login"/>
    <route method="post" uri="login" controller="App\Portal\Controllers\LoginController" use="doLogin"/>
    <route method="get" uri="logout" controller="App\Portal\Controllers\LoginController" use="logout" as="logout"/>

    <!-- VÍZJELES KÉPGENERÁLÁS -->
    <route method="get" uri="/media/{entity_type}/images/{image}" as="watermark_image" controller="App\Portal\Controllers\ImageController" use="getImageWithWatermark"/>

    <!-- Adatbázisban tárolt statikus oldalak. FIGYELEM!!!! EZ ALÁ MÁR NE KERÜLJÖN ROUTE!!! -->
    <route method="get" uri="{slug}" controller="App\Portal\Controllers\PageController" use="page" as="portal.page" middleware="App\Middleware\ComingSoon"/>
</routes>
